var input = [['lf_AND_lq','ls'],['iu_RSHIFT_1','jn'],['bo_OR_bu','bv'],['gj_RSHIFT_1','hc'],['et_RSHIFT_2','eu'],['bv_AND_bx','by'],['is_OR_it','iu'],['b_OR_n','o'],['gf_OR_ge','gg'],['_NOT_kt','ku'],['ea_AND_eb','ed'],['kl_OR_kr','ks'],['hi_AND_hk','hl'],['au_AND_av','ax'],['lf_RSHIFT_2','lg'],['dd_RSHIFT_3','df'],['eu_AND_fa','fc'],['df_AND_dg','di'],['ip_LSHIFT_15','it'],['_NOT_el','em'],['et_OR_fe','ff'],['fj_LSHIFT_15','fn'],['t_OR_s','u'],['ly_OR_lz','ma'],['ko_AND_kq','kr'],['_NOT_fx','fy'],['et_RSHIFT_1','fm'],['eu_OR_fa','fb'],['dd_RSHIFT_2','de'],['_NOT_go','gp'],['kb_AND_kd','ke'],['hg_OR_hh','hi'],['jm_LSHIFT_1','kg'],['_NOT_cn','co'],['jp_RSHIFT_2','jq'],['jp_RSHIFT_5','js'],['1_AND_io','ip'],['eo_LSHIFT_15','es'],['1_AND_jj','jk'],['g_AND_i','j'],['ci_RSHIFT_3','ck'],['gn_AND_gp','gq'],['fs_AND_fu','fv'],['lj_AND_ll','lm'],['jk_LSHIFT_15','jo'],['iu_RSHIFT_3','iw'],['_NOT_ii','ij'],['1_AND_cc','cd'],['bn_RSHIFT_3','bp'],['_NOT_gw','gx'],['_NOT_ft','fu'],['jn_OR_jo','jp'],['iv_OR_jb','jc'],['hv_OR_hu','hw'],['19138','b'],['gj_RSHIFT_5','gm'],['hq_AND_hs','ht'],['dy_RSHIFT_1','er'],['ao_OR_an','ap'],['ld_OR_le','lf'],['bk_LSHIFT_1','ce'],['bz_AND_cb','cc'],['bi_LSHIFT_15','bm'],['il_AND_in','io'],['af_AND_ah','ai'],['as_RSHIFT_1','bl'],['lf_RSHIFT_3','lh'],['er_OR_es','et'],['_NOT_ax','ay'],['ci_RSHIFT_1','db'],['et_AND_fe','fg'],['lg_OR_lm','ln'],['k_AND_m','n'],['hz_RSHIFT_2','ia'],['kh_LSHIFT_1','lb'],['_NOT_ey','ez'],['_NOT_di','dj'],['dz_OR_ef','eg'],['lx','a'],['_NOT_iz','ja'],['gz_LSHIFT_15','hd'],['ce_OR_cd','cf'],['fq_AND_fr','ft'],['at_AND_az','bb'],['ha_OR_gz','hb'],['fp_AND_fv','fx'],['_NOT_gb','gc'],['ia_AND_ig','ii'],['gl_OR_gm','gn'],['0','c'],['_NOT_ca','cb'],['bn_RSHIFT_1','cg'],['c_LSHIFT_1','t'],['iw_OR_ix','iy'],['kg_OR_kf','kh'],['dy_OR_ej','ek'],['km_AND_kn','kp'],['_NOT_fc','fd'],['hz_RSHIFT_3','ib'],['_NOT_dq','dr'],['_NOT_fg','fh'],['dy_RSHIFT_2','dz'],['kk_RSHIFT_2','kl'],['1_AND_fi','fj'],['_NOT_hr','hs'],['jp_RSHIFT_1','ki'],['bl_OR_bm','bn'],['1_AND_gy','gz'],['gr_AND_gt','gu'],['db_OR_dc','dd'],['de_OR_dk','dl'],['as_RSHIFT_5','av'],['lf_RSHIFT_5','li'],['hm_AND_ho','hp'],['cg_OR_ch','ci'],['gj_AND_gu','gw'],['ge_LSHIFT_15','gi'],['e_OR_f','g'],['fp_OR_fv','fw'],['fb_AND_fd','fe'],['cd_LSHIFT_15','ch'],['b_RSHIFT_1','v'],['at_OR_az','ba'],['bn_RSHIFT_2','bo'],['lh_AND_li','lk'],['dl_AND_dn','do'],['eg_AND_ei','ej'],['ex_AND_ez','fa'],['_NOT_kp','kq'],['_NOT_lk','ll'],['x_AND_ai','ak'],['jp_OR_ka','kb'],['_NOT_jd','je'],['iy_AND_ja','jb'],['jp_RSHIFT_3','jr'],['fo_OR_fz','ga'],['df_OR_dg','dh'],['gj_RSHIFT_2','gk'],['gj_OR_gu','gv'],['_NOT_jh','ji'],['ap_LSHIFT_1','bj'],['_NOT_ls','lt'],['ir_LSHIFT_1','jl'],['bn_AND_by','ca'],['lv_LSHIFT_15','lz'],['ba_AND_bc','bd'],['cy_LSHIFT_15','dc'],['ln_AND_lp','lq'],['x_RSHIFT_1','aq'],['gk_OR_gq','gr'],['_NOT_kx','ky'],['jg_AND_ji','jj'],['bn_OR_by','bz'],['fl_LSHIFT_1','gf'],['bp_OR_bq','br'],['he_OR_hp','hq'],['et_RSHIFT_5','ew'],['iu_RSHIFT_2','iv'],['gl_AND_gm','go'],['x_OR_ai','aj'],['hc_OR_hd','he'],['lg_AND_lm','lo'],['lh_OR_li','lj'],['da_LSHIFT_1','du'],['fo_RSHIFT_2','fp'],['gk_AND_gq','gs'],['bj_OR_bi','bk'],['lf_OR_lq','lr'],['cj_AND_cp','cr'],['hu_LSHIFT_15','hy'],['1_AND_bh','bi'],['fo_RSHIFT_3','fq'],['_NOT_lo','lp'],['hw_LSHIFT_1','iq'],['dd_RSHIFT_1','dw'],['dt_LSHIFT_15','dx'],['dy_AND_ej','el'],['an_LSHIFT_15','ar'],['aq_OR_ar','as'],['1_AND_r','s'],['fw_AND_fy','fz'],['_NOT_im','in'],['et_RSHIFT_3','ev'],['1_AND_ds','dt'],['ec_AND_ee','ef'],['_NOT_ak','al'],['jl_OR_jk','jm'],['1_AND_en','eo'],['lb_OR_la','lc'],['iu_AND_jf','jh'],['iu_RSHIFT_5','ix'],['bo_AND_bu','bw'],['cz_OR_cy','da'],['iv_AND_jb','jd'],['iw_AND_ix','iz'],['lf_RSHIFT_1','ly'],['iu_OR_jf','jg'],['_NOT_dm','dn'],['lw_OR_lv','lx'],['gg_LSHIFT_1','ha'],['lr_AND_lt','lu'],['fm_OR_fn','fo'],['he_RSHIFT_3','hg'],['aj_AND_al','am'],['1_AND_kz','la'],['dy_RSHIFT_5','eb'],['jc_AND_je','jf'],['cm_AND_co','cp'],['gv_AND_gx','gy'],['ev_OR_ew','ex'],['jp_AND_ka','kc'],['fk_OR_fj','fl'],['dy_RSHIFT_3','ea'],['_NOT_bs','bt'],['_NOT_ag','ah'],['dz_AND_ef','eh'],['cf_LSHIFT_1','cz'],['_NOT_cv','cw'],['1_AND_cx','cy'],['de_AND_dk','dm'],['ck_AND_cl','cn'],['x_RSHIFT_5','aa'],['dv_LSHIFT_1','ep'],['he_RSHIFT_2','hf'],['_NOT_bw','bx'],['ck_OR_cl','cm'],['bp_AND_bq','bs'],['as_OR_bd','be'],['he_AND_hp','hr'],['ev_AND_ew','ey'],['1_AND_lu','lv'],['kk_RSHIFT_3','km'],['b_AND_n','p'],['_NOT_kc','kd'],['lc_LSHIFT_1','lw'],['km_OR_kn','ko'],['id_AND_if','ig'],['ih_AND_ij','ik'],['jr_AND_js','ju'],['ci_RSHIFT_5','cl'],['hz_RSHIFT_1','is'],['1_AND_ke','kf'],['_NOT_gs','gt'],['aw_AND_ay','az'],['x_RSHIFT_2','y'],['ab_AND_ad','ae'],['ff_AND_fh','fi'],['ci_AND_ct','cv'],['eq_LSHIFT_1','fk'],['gj_RSHIFT_3','gl'],['u_LSHIFT_1','ao'],['_NOT_bb','bc'],['_NOT_hj','hk'],['kw_AND_ky','kz'],['as_AND_bd','bf'],['dw_OR_dx','dy'],['br_AND_bt','bu'],['kk_AND_kv','kx'],['ep_OR_eo','eq'],['he_RSHIFT_1','hx'],['ki_OR_kj','kk'],['_NOT_ju','jv'],['ek_AND_em','en'],['kk_RSHIFT_5','kn'],['_NOT_eh','ei'],['hx_OR_hy','hz'],['ea_OR_eb','ec'],['s_LSHIFT_15','w'],['fo_RSHIFT_1','gh'],['kk_OR_kv','kw'],['bn_RSHIFT_5','bq'],['_NOT_ed','ee'],['1_AND_ht','hu'],['cu_AND_cw','cx'],['b_RSHIFT_5','f'],['kl_AND_kr','kt'],['iq_OR_ip','ir'],['ci_RSHIFT_2','cj'],['cj_OR_cp','cq'],['o_AND_q','r'],['dd_RSHIFT_5','dg'],['b_RSHIFT_2','d'],['ks_AND_ku','kv'],['b_RSHIFT_3','e'],['d_OR_j','k'],['_NOT_p','q'],['_NOT_cr','cs'],['du_OR_dt','dv'],['kf_LSHIFT_15','kj'],['_NOT_ac','ad'],['fo_RSHIFT_5','fr'],['hz_OR_ik','il'],['jx_AND_jz','ka'],['gh_OR_gi','gj'],['kk_RSHIFT_1','ld'],['hz_RSHIFT_5','ic'],['as_RSHIFT_2','at'],['_NOT_jy','jz'],['1_AND_am','an'],['ci_OR_ct','cu'],['hg_AND_hh','hj'],['jq_OR_jw','jx'],['v_OR_w','x'],['la_LSHIFT_15','le'],['dh_AND_dj','dk'],['dp_AND_dr','ds'],['jq_AND_jw','jy'],['au_OR_av','aw'],['_NOT_bf','bg'],['z_OR_aa','ab'],['ga_AND_gc','gd'],['hz_AND_ik','im'],['jt_AND_jv','jw'],['z_AND_aa','ac'],['jr_OR_js','jt'],['hb_LSHIFT_1','hv'],['hf_OR_hl','hm'],['ib_OR_ic','id'],['fq_OR_fr','fs'],['cq_AND_cs','ct'],['ia_OR_ig','ih'],['dd_OR_do','dp'],['d_AND_j','l'],['ib_AND_ic','ie'],['as_RSHIFT_3','au'],['be_AND_bg','bh'],['dd_AND_do','dq'],['_NOT_l','m'],['1_AND_gd','ge'],['y_AND_ae','ag'],['fo_AND_fz','gb'],['_NOT_ie','if'],['e_AND_f','h'],['x_RSHIFT_3','z'],['y_OR_ae','af'],['hf_AND_hl','hn'],['_NOT_h','i'],['_NOT_hn','ho'],['he_RSHIFT_5','hh']];

var wires = {};
var saves = {}; //dp

for (var i = 0; i < input.length; i++) {
    inst = input[i][0];
    out = input[i][1];
    wires[out] = inst;
}

var trace = function(key) {
    if(saves[key] !== undefined) { return saves[key]; }

    var ret;

    var num = Number(key);
    var arr = wires[key] ? wires[key].split('_') : [];
    if(!isNaN(num)) { 
        ret = num;
    } else if (arr.length === 1) {
        //check for plain assignment
        ret = trace(arr[0]);
    } else if(arr[1] === 'NOT') {
        ret = ~(trace(arr[2]));
    } else if(arr[1] === 'OR') {
        ret = trace(arr[0]) | trace(arr[2]);
    } else if(arr[1] === 'AND') {
        ret = trace(arr[0]) & trace(arr[2]);
    } else if(arr[1] === 'LSHIFT') {
        ret = trace(arr[0]) << trace(arr[2]);
    } else if(arr[1] === 'RSHIFT') {
        ret = trace(arr[0]) >> trace(arr[2]);
    } else {
        console.log('ERROR' + key);
    }
    
    ret = ret & 65535;
        
    saves[key] = ret;
    return ret;
}

var part1 = trace('a') & 65535;
console.log('wire a is: ' + part1);

saves = {'b' : part1 };
var part2 = trace('a') & 65535;
console.log('after setting wire b, wire a is: ' + part2);
